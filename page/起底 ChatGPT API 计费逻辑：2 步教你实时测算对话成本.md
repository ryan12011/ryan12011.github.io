å½“ä½ æ­£åœ¨è°ƒç”¨ ChatGPT API æ—¶ï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡å®ƒæ˜¯å¦‚ä½•è¿›è¡Œè®¡è´¹çš„ï¼Ÿé€šè¿‡å®˜ç½‘æŸ¥è¯¢å¾—çŸ¥ï¼ŒAPI çš„è®¡è´¹ç­–ç•¥é‡‡ç”¨**æŒ‰ä½¿ç”¨é‡ä»˜è´¹**ï¼Œç”¨å¤šå°‘æ‰£å¤šå°‘ã€‚

![ChatGPT API è®¡è´¹é€»è¾‘](https://cdn.apifox.cn/blog/2025/09/image-5.png)

ä½†æ˜¯é—®é¢˜æ¥äº†ï¼ŒAPI æœåŠ¡é‡Œçš„è¿™ä¸ª **â€œæŒ‰é‡è®¡è´¹â€ çš„ â€œé‡â€ åº”è¯¥æ€ä¹ˆç®—ï¼Ÿ**

ä¹Ÿè®¸ä½ ä¼šè¯´ï¼Œé‚£è¿˜ä¸ç®€å•ï¼Œç›´æ¥çœ‹å®ƒå›ç­”äº†å¤šå°‘å­—æ•°å‘—ï¼è¿™è¯åªå¯¹äº†ä¸€åŠã€‚å› ä¸º ChatGPT ä¸ä»…ä¼šè®²ä¸­æ–‡ï¼Œå®ƒè¿˜å¯ä»¥æ ¹æ®ä½¿ç”¨è€…æ‰€å‘é€çš„è¯­è¨€ï¼Œå›ç­”å‡ºè‹±è¯­ã€æ³•è¯­ã€è¥¿è¯­ç­‰å¤šå›½è¯­è¨€ã€‚ç›¸åŒæ„æ€ä¸‹æ¯ä¸ªè¯­è¨€çš„é•¿åº¦éƒ½ä¼šä¸ä¸€æ ·ï¼Œæ‰€ä»¥å®ƒä¼šå°†è¿™äº›å†…å®¹ç»Ÿä¸€æ¢ç®—ä¸ºå¦ä¸€ä¸ªæ ‡å‡†å•ä½â€”â€”**Tokens**ï¼Œç„¶åå†è¿›è¡Œè®¡è´¹ã€‚

ChatGPT ä¸ä»…ä¼šç»Ÿè®¡è‡ªå·±è¾“å‡ºäº†å¤šå°‘å†…å®¹ï¼Œè¿˜ä¼šè®°å½•ç”¨æˆ·è¾“å…¥äº†å¤šå°‘å†…å®¹ï¼Œæ¯•ç«Ÿå®ƒä¹Ÿéœ€è¦å…ˆåˆ†æè¾“å…¥çš„æ–‡æœ¬æ‰èƒ½è¾“å‡ºæœ‰æ„ä¹‰çš„å›ç­”ã€‚ç»Ÿä¸€æ¢ç®—ä¸º Tokens å€¼åæ±‡æ€»è´¹ç”¨ã€‚ä»¥ä¸‹æ˜¯ ChatGPT API çš„å®˜æ–¹æ”¶è´¹è¡¨ï¼Œé‡Œé¢çš„ 4Kã€8K ç­‰æ•°æ®ä»£è¡¨å•æ¬¡é—®ç­”ä¸­çš„æœ€å¤§ä¸Šä¸‹æ–‡ Tokens å€¼ã€‚

![ChatGPT API ä»·æ ¼è¡¨](https://cdn.apifox.cn/blog/2025/09/image-7.png)

å¦‚æœä½ å·²ç»é€šè¿‡ ChatGPT API æˆåŠŸåœ°å°† AI èƒ½åŠ›åµŒå…¥è‡³å•†ä¸šåŒ–äº§å“ä¸­ï¼Œæ¯”å¦‚è¯´æ‰“é€ å‡ºäº†ä¸€ä¸ªå¯¹å®¢æä¾›æœåŠ¡çš„æ™ºèƒ½å®¢æœï¼Œé‚£ä¹ˆä½œä¸ºå¼€å‘äººå‘˜çš„ä½ **éœ€è¦ç«‹åˆ»ã€é©¬ä¸Šã€æ¸…æ¥šåœ°çŸ¥é“æ¯ä¸ªå®¢æˆ·çš„é—®ç­”æ‰€äº§ç”Ÿçš„æ¶ˆè€—é¢**ã€‚å› ä¸ºå…¬å¸éœ€è¦çŸ¥é“æœ€åŸºç¡€çš„æˆæœ¬æ‰èƒ½åˆ¶å®šå‡ºåˆç†çš„è¿è¥ç­–ç•¥ã€‚

æ€»ä¸èƒ½ä¾é å®æ—¶ç›‘æ§ OpenAI çš„è´¦å·åå°æ¥æŸ¥çœ‹æ‰€æ¶ˆè€—çš„æˆæœ¬å§ï¼Ÿï¼ˆæ›´ä½•å†µå®ƒè¿˜æœ‰äº”åˆ†é’Ÿçš„å»¶è¿Ÿï¼‰

![å®æ—¶ç›‘æ§æˆæœ¬](https://cdn.apifox.cn/blog/2025/09/image-9.png)

é‚£æ€æ ·æ‰èƒ½åœ¨ä½¿ç”¨ Apifox è°ƒç”¨ API çš„è¿‡ç¨‹ä¸­å°±ç›´æ¥çœ‹åˆ°è¾“å…¥å’Œè¾“å‡ºçš„äººæ°‘å¸æˆæœ¬å‘¢ï¼Ÿé€šè¿‡ä»¥ä¸‹ 2 æ­¥å°±èƒ½å¤Ÿæ¸…æ¥šåœ°çœ‹åˆ°äººæ°‘å¸èŠ±è´¹ï¼š

> **1. è®¡ç®—è¾“å…¥/è¾“å‡º Tokens å€¼**  
> **2. åŸºäºå®æ—¶æ±‡ç‡æ¢ç®—äººæ°‘å¸æˆæœ¬**

---

## è®¡ç®—è¾“å…¥ / è¾“å‡º Tokens

### åˆ›å»ºæ¢ç®—è„šæœ¬

å°†å†…å®¹å‡†ç¡®æ¢ç®—ä¸º Tokens éœ€è¦å¼•ç”¨ç¬¬ä¸‰æ–¹ Token æ¢ç®—åº“ã€‚ä¸‹é¢å°†ä»¥ [OpenAI GPT Token Counter åº“](https://bit.ly/bewildcard)ä¸ºä¾‹ï¼Œä½¿å¾—èƒ½å¤Ÿåœ¨è°ƒè¯•æ¥å£çš„è¿‡ç¨‹ä¸­å°†è¾“å…¥/è¾“å‡ºæ•°æ®æ¢ç®—ä¸º Tokens æ•°ã€‚

å®‰è£…ç¬¬ä¸‰æ–¹åº“çš„è¿è¡Œç¯å¢ƒï¼š

bash
npm install openai-gpt-token-counter


å‚è€ƒä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼Œæ–°å»ºåä¸º `gpt-tokens-counter.js` çš„ Node.js è„šæœ¬ï¼š

javascript
const openaiTokenCounter = require('openai-gpt-token-counter');

const text = process.argv[2]; // è·å–å‘½ä»¤è¡Œå‚æ•°ä¸­çš„æµ‹è¯•å†…å®¹
const model = "gpt-4"; // æ›¿æ¢ä¸ºä½ æƒ³è¦ä½¿ç”¨çš„ OpenAI æ¨¡å‹

const tokenCount = openaiTokenCounter.text(text, model);
const characterCount = text.length; // è®¡ç®—å­—ç¬¦æ•°

console.log(`${tokenCount}`);


å°†è¯¥è„šæœ¬æ–‡ä»¶æ”¾ç½®äº Apifox çš„**å¤–éƒ¨ç¨‹åºç›®å½•**ä¸‹ä»¥ä¾›è°ƒç”¨ï¼š

![å¤–éƒ¨ç¨‹åºç›®å½•](https://cdn.apifox.cn/blog/2025/09/image-10.png)

---

### æ¢ç®— Tokens è¾“å…¥å€¼

è¾“å…¥å€¼å°±æ˜¯åœ¨è¯¢é—® ChatGPT æ—¶æ‰€å¡«å†™çš„é—®é¢˜ã€‚ä½ å¯ä»¥åœ¨ â€œèŠå¤©æ¶ˆæ¯â€ API æ–‡æ¡£çš„**å‰ç½®æ“ä½œ**ä¸­æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰è„šæœ¬ï¼Œä½¿å¾— Apifox èƒ½å¤Ÿè°ƒç”¨ä¸Šæ–‡ä¸­å†™å¥½çš„ Tokens æ¢ç®—è„šæœ¬ï¼Œæå–ä½äºè¯·æ±‚å‚æ•° Body ä¸­çš„ `content` å‚æ•°åæ¢ç®—ä¸º Tokens å€¼ã€‚

![å‰ç½®æ“ä½œ](https://cdn.apifox.cn/blog/2025/09/image-11.png)

å¡«å†™ä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼š

javascript
try {
  var jsonData = JSON.parse(pm.request.body.raw);
  var content = jsonData.messages[0].content; // è·å– content ä¸­çš„ä¿¡æ¯
  var result_input_tokens_js = pm.execute('./gpt-tokens/gpt-tokens-counter.js', [content]);
  console.log(content);
  pm.environment.set("RESULT_INPUT_TOKENS", result_input_tokens_js);
  console.log("Input Tokens count: " + pm.environment.get("RESULT_INPUT_TOKENS"));
} catch (e) {
    console.log(e);
}


ç‚¹å‡» â€œè¿è¡Œâ€ æŒ‰é’®åå¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°å·²ç»Ÿè®¡çš„è¾“å…¥å€¼ã€‚

![ç»Ÿè®¡è¾“å…¥å€¼](https://cdn.apifox.cn/blog/2025/09/image-12.png)

---

### æ¢ç®— Tokens è¾“å‡ºå€¼

æ¥ä¸‹æ¥éœ€è¦è®¡ç®— ChatGPT è¾“å‡ºäº†å¤šå°‘ä¸ª Tokensã€‚

ChatGPT é‡‡ç”¨ SSEï¼ˆServer-Sent Eventsï¼ŒæœåŠ¡å™¨æ¨é€äº‹ä»¶ï¼‰è¾“å‡ºå›ç­”ï¼Œå¥½å¤„åœ¨äºå¯ä»¥å®æ—¶æ˜¾ç¤ºé—®é¢˜çš„ç­”æ¡ˆã€‚å½“ç”¨æˆ·çœ‹åˆ° GPT æ­£åœ¨è¯´è¯ä¹Ÿå°±æ›´æœ‰è€å¿ƒçš„ç­‰ä¸‹å»ã€‚è¿™ç§æ–¹å¼ä¸åƒæ™®é€šçš„ API æ˜¯å•æ¬¡çš„è¯·æ±‚å’Œè¿”å›ï¼Œè€Œæ˜¯å»ºç«‹è¿æ¥åè¾“å‡ºä¸€ä¸ªè¿ç»­çš„æ—¶é—´çº¿ã€‚

å› æ­¤æˆ‘ä»¬éœ€è¦å…ˆæ‹¼æ¥æ‰€æœ‰çš„è¾“å‡ºå†…å®¹ï¼Œç„¶åå†è¿›è¡Œ Tokens æ¢ç®—ã€‚

![æ‹¼æ¥è¾“å‡ºå†…å®¹](https://cdn.apifox.cn/blog/2025/09/image-13.png)

åœ¨**åç½®æ“ä½œ**ä¸­æ·»åŠ ä»¥ä¸‹è‡ªå®šä¹‰è„šæœ¬ï¼Œæ‹¼æ¥æ‰€æœ‰è¾“å‡ºå†…å®¹å¹¶æ¢ç®— Tokensï¼š

javascript
// è·å–å“åº”çš„æ–‡æœ¬å†…å®¹
const text = pm.response.text();
// å°†æ–‡æœ¬å†…å®¹åˆ†å‰²æˆè¡Œæ•°
var lines = text.split('\n');
// åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„å­˜å‚¨ "content" å‚æ•°
var contents = [];
// éå†æ¯ä¸€è¡Œ
for (var i = 0; i < lines.length; i++) {
    const line = lines[i];
    // è·³è¿‡ä¸ä»¥ "data:" å¼€å¤´çš„è¡Œ
    if (!line.startsWith('data:')) {
        continue;
    }
    // å°è¯•è§£æ JSON æ•°æ®
    try {
        var data = JSON.parse(line.substring(5).trim());  // ç§»é™¤å‰é¢çš„ "data: "
        // ä» "choices" æ•°ç»„ä¸­è·å– "content" å‚æ•°å¹¶å°†å…¶æ·»åŠ åˆ°æ•°ç»„ä¸­
        contents.push(data.choices[0].delta.content);
    } catch (e) {
        // å¦‚æœå½“å‰è¡Œä¸æ˜¯æœ‰æ•ˆçš„ JSON æ•°æ®ï¼Œåˆ™å¿½ç•¥è¯¥è¡Œ
    }
}
// ä½¿ç”¨ join() æ–¹æ³•å°† "content" å‚æ•°åˆå¹¶èµ·æ¥
var result = contents.join('');
// åœ¨ "Visualize" é€‰é¡¹å¡ä¸­æ˜¾ç¤ºç»“æœ
pm.visualizer.set(result);
// å°†ç»“æœæ‰“å°åˆ°æ§åˆ¶å°
console.log(result);

// è®¡ç®—è¾“å‡ºä»¤ç‰Œçš„æ•°é‡
var RESULT_OUTPUT_TOKENS = pm.execute('./gpt-tokens/gpt-tokens-counter.js', [result]);
pm.environment.set("RESULT_OUTPUT_TOKENS", RESULT_OUTPUT_TOKENS);

console.log("Output Tokens count: " + pm.environment.get("RESULT_OUTPUT_TOKENS"));


ç‚¹å‡» â€œè¿è¡Œâ€ æŒ‰é’®åå¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°å·²ç»Ÿè®¡çš„è¾“å‡ºå€¼ã€‚

![ç»Ÿè®¡è¾“å‡ºå€¼](https://cdn.apifox.cn/blog/2025/09/image-14.png)

---

## åŸºäºå®æ—¶æ±‡ç‡æ¢ç®—äººæ°‘å¸æˆæœ¬

å¾—åˆ°è¾“å…¥å’Œè¾“å‡ºæ‰€è€—è´¹çš„ Tokens å€¼åï¼Œå› ä¸º ChatGPT é‡‡ç”¨ç¾å…ƒè®¡ä»·ï¼Œå› æ­¤è¿˜éœ€è¦è°ƒç”¨å®æ—¶æ±‡ç‡ API åæ‰èƒ½é¢„ä¼°æ‰€æ¶ˆè€—çš„äººæ°‘å¸æˆæœ¬ã€‚

### è®¡ç®—è¾“å…¥æˆæœ¬

åœ¨**å‰ç½®æ“ä½œ**ä¸­æ–°å¢ä»¥ä¸‹è„šæœ¬ï¼š

javascript
// å‘é€è¯·æ±‚ä»¥è·å– USD åˆ° CNY çš„æ±‡ç‡
pm.sendRequest("http://apilayer.net/api/live?access_key=YOUR-API-KEY&currencies=CNY&source=USD&format=1", (err, res) => {
  if (err) {
    console.log(err);
  } else {
    const quotes = res.json().quotes;
    const rate = parseFloat(quotes.USDCNY).toFixed(3);
    pm.environment.set("USDCNY_RATE", rate); 
    var USDCNY_RATE = pm.environment.get("USDCNY_RATE");
    var RESULT_INPUT_TOKENS = pm.environment.get("RESULT_INPUT_TOKENS");

    const tokensExchangeRate = 0.03; // æ¯ 1000 ä¸ªä»¤ç‰Œçš„ä»·æ ¼ï¼ˆç¾å…ƒï¼‰
    const CNYPrice = ((RESULT_INPUT_TOKENS / 1000) * tokensExchangeRate * USDCNY_RATE).toFixed(2);

    pm.environment.set("INPUT_PRICE", CNYPrice); 
    console.log("Estimated cost: " + "ï¿¥" + CNYPrice);
  }
});


ç‚¹å‡» â€œè¿è¡Œâ€ æŒ‰é’®åå¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°é¢„ä¼°çš„äººæ°‘å¸æˆæœ¬ã€‚

![è¾“å…¥æˆæœ¬](https://cdn.apifox.cn/blog/2025/09/image-15.png)

---

### è®¡ç®—è¾“å‡ºæˆæœ¬

åœ¨**åç½®æ“ä½œ**ä¸­æ·»åŠ ä»¥ä¸‹è„šæœ¬ï¼š

javascript
pm.sendRequest("http://apilayer.net/api/live?access_key=YOUR-API-KEY&currencies=CNY&source=USD&format=1", (err, res) => {
  if (err) {
    console.log(err);
  } else {
    const quotes = res.json().quotes;
    const rate = parseFloat(quotes.USDCNY).toFixed(3);
    pm.environment.set("USDCNY_RATE", rate); 
    var USDCNY_RATE = pm.environment.get("USDCNY_RATE");
    var RESULT_OUTPUT_TOKENS = pm.environment.get("RESULT_OUTPUT_TOKENS");

    const tokensExchangeRate = 0.06; // æ¯ 1000 ä¸ªä»¤ç‰Œçš„ä»·æ ¼ï¼ˆç¾å…ƒï¼‰
    const CNYPrice = ((RESULT_OUTPUT_TOKENS / 1000) * tokensExchangeRate * USDCNY_RATE).toFixed(2);

    pm.environment.set("OUTPUT_PRICE", CNYPrice); 
    console.log("Output cost (CNY): " + "ï¿¥" + CNYPrice);
  }
});


ç‚¹å‡» â€œè¿è¡Œâ€ æŒ‰é’®åå¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°è¾“å‡ºå€¼çš„é¢„ä¼°äººæ°‘å¸èŠ±è´¹ã€‚

![è¾“å‡ºæˆæœ¬](https://cdn.apifox.cn/blog/2025/09/image-16.png)

---

### é¢„ä¼°æ€»æˆæœ¬

æœ€åè¿˜å¯ä»¥åœ¨åç½®æ“ä½œä¸­æ·»åŠ ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨è®¡ç®—è¾“å…¥+è¾“å‡ºæ€»æˆæœ¬çš„æ­¥éª¤ï¼š

javascript
const INPUTPrice = Number(pm.environment.get("INPUT_PRICE"));
const OUTPUTPrice = Number(pm.environment.get("OUTPUT_PRICE"));

console.log("æ€»æˆæœ¬ï¼š" + (INPUTPrice + OUTPUTPrice) + "å…ƒ");


è¿™æ ·å°±èƒ½å¤Ÿåœ¨è°ƒè¯• ChatGPT API çš„è¿‡ç¨‹ä¸­é¢„ä¼°å‡ºå¤§è‡´çš„è¾“å…¥è¾“å‡ºæ€»æˆæœ¬ã€‚

![æ€»æˆæœ¬](https://cdn.apifox.cn/blog/2025/09/image-17.png)

---

ç°åœ¨ä½ ä¸ä»…å¯ä»¥åœ¨ Apifox ä¸­æ„‰å¿«åœ°è°ƒç”¨ ChatGPT APIï¼Œè¿˜èƒ½å¤Ÿæ¸…æ¥šæŒæ¡ä½ çš„è°ƒç”¨æˆæœ¬ï¼Œåšåˆ°å¿ƒä¸­æœ‰æ•°ã€‚

ğŸ‘‰ [WildCard | ä¸€åˆ†é’Ÿæ³¨å†Œï¼Œè½»æ¾è®¢é˜…æµ·å¤–çº¿ä¸ŠæœåŠ¡](https://bit.ly/bewildcard)